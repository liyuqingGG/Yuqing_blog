---
title: unittest
date: 2022-04-26 22:08:42
permalink: /pages/a13db2/
categories:
  - 记录
  - Python
  - Unittest
tags:
  - 
titleTag: 原创
---
## TestCase  测试用例
1. 定义一个测试用例类，必须继承unittest模块中的TestCase类
2. 测试用例类中，一个test开头的就是一条测试用例
3. 将测试用例执行的代码逻辑写到对应的测试方法中
    - 准备用例数据(返回值）
    - 调用被测功能函数(接口)，获取实际结果
    - 断言
```py
# 以下以写死的登录验证功能函数为例
# 定义登录验证功能函数
def login(username,password):
  if username != None and password != None:
    if username == 'admin' and password == 123:
      return {'code':0,'msg':'登录成功'}
    else:
      return {'code':1,'msg':'账号或密码错误'}
  else:
    return {'code':3,'msg':'输入不能为空'}

# 创建测试用例类，并编写测试用例
import unittest
class login_test(unittest.TestCase):
  # 定义一个参数正确的测试用例,注意需要以test开头
  def test_login_ok(self):
    # 1.准备用例数据(参数和预期结果)
    parms = {'user':'admin','passwrod':123}
    expected = {'code':0,'msg':'登录成功'}
    # 执行登录验证功能函数获取实际结果
    res = login(**parms)
    # 断言
    assert res == expected
  # 以下如果需要继续编写执行测试用例，按上述test_login_ok等方式继续编写即可
```

## TestSuite 测试集合/套件
1. 创建测试套件，加载测试用例
2. 创建一个测试用例运行程序
3. 运行测试用例
```py
import unittest
# 一.创建测试套件，加载测试用例
#  1.创建测试套件
suite = unittest.TestSuite()
#  2.创建用例加载器
load = unittest.TestLoader()
#  3.把用例加载器加载用例并且放到测试套件中
suite.addTest(load.discover('路径'))
# 以上1-3注释说明的代码，一行替代方式
suite = unittest.defalutTestLoader.discover('路径')

# 二，创建一个测试用例运行程序
runer = unittest.TextTestRunner()

# 三，运行测试用例
runer.run(suite)
```

## unnittestreprot
```py
pip install unittestreport
from unittestreport import TestRunner
suite = unittest.defaultTestLoader.discover('路径')
run = TestRunner(suite)
run.run()
```

## TestRunner 测试运行
见上面TestSuite

## fixtrue 测试夹具
**一：**
  1. setUp 用例级别的前置：每条用例执行前执行
  2. tearDown 用例级别的后置：每条用例执行后执行
**二：**
  1. setUpclass 测试类级别的前置
  2. tearDownclass 测试类列级别的后置
```py
class Test_xxx(unnittest.TestCase):
  @classmethod
  def setUpclass(cls):
    pass
  @classmethod
  def tearDownclass(cls):
    pass

  def setUp(self):
    pass
  def tearDown(self):
    pass
```

## DDT（Data Driver Test）
1. 测试类前@ddt
2. 测试方法前@list_ddt(测试数据)
3. 测试方法中定义一个参数 用来接受用例数据
```py
import unittest
from unittestreport import ddt,list_data
from XXX import login_check
# 测试数据
aa = [
  {'expected':{'code':'0','msg':'正确'},'parms':{'user':'admin','pwd':123}},
  {'expected':{'code':'1','msg':'错误'},'parms':{'user':'admin','pwd':000}},
]
@ddt
class Test_login(unittest.TestCase):
@list_ddt(aa)
  def test_login(self,items):
    data = items['expected']
    canshu = ilems['parms']
    shiji = login_check(**data)


``` 

### DDT底层原理
有空补

## openpyxl
pip install openpyxl