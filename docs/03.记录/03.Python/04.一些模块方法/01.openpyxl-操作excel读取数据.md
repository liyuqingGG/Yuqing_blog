---
title: openpyxl-操作excel读取数据
date: 2022-02-22 11:26:52
permalink: /pages/44c83f/
categories:
  - 记录
  - Python
  - 一些模块方法
tags:
  - 
titleTag: 原创
---
## openpyxl基本使用
pip install openpyxl
1. 把excel解析为**Workbook**：工作薄对象
2. Sheet：表单对象
3. Cell：表格对象 
<!-- more -->

```py
# 读
# 1.导入openpyxl模块，解析指定excel
workbook = openpyxl.load_workbook('excel路径')
# 2.指定解析的sheet
sheet = workbook['sheet名']
# 3.按行读取cell并转换为list存储
cell = list(sheet.rows)
# 4.此时cell是一个列表嵌套元组的形式，元祖包括读取到的cell表格，用下标取值后遍历，单个的cell拥有value方法，可读取单个cell格子的值
data = [i.value for i in cell[0]]
# 5.此时data为该sheet的第一行的所有值
print(data)

# 写
# 1.导入openpyxl模块，解析指定excel
workbook = openpyxl.load_workbook('excel路径')
# 2.指定解析的sheet
sheet = workbook['sheet名']
# 3.写入需要cell方法并传入row,column,value
sheet.cell(row=1,colum=1,'hello')
# 4.此时数据在该sheet的第一行，第一列即A1的单元格写入了hello，但此时表中数据还没有变，需要保存
workbook.save('excel路径')
```

## openpyxl封装
