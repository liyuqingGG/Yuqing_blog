---
title: jmeter
date: 2022-04-20 09:32:09
permalink: /pages/7ab77c/
categories:
  - 技术
  - 测试
  - 接口测试
tags:
  - jmeter
---

### 遇到得一些问题
1. 响应数据返回的中文显示乱码
    - 解决：添加后置处理器BeanShell PostProcessor，输入prev.setDataEncoding("utf-8");

### jmeter进行接口测试的原理
1. 用工具去模拟客户端发起请求，服务器接受请求返回结果，工具模拟客户端接受请求 fiddler原理？？？？

### jmeter简单请求http协议接口使用
1. **jmeter for mac 配置**
    - 下载java JDK 推荐8，版本太高jmeter无法保存文件
    - 下载jmeter
    - sudu spctl --master-disable--->系统偏好设置---->安全性隐私--->通用--->任何来源
2. **jmeter 使用**
    1. 创建线程组
        - 线程数 == 并发数 普通功能测试1，涉及性能按照需求更改
        - 循环次数 针对每个线程的循环
    2. 添加sampler(采样器)
        - 选择协议(http)
        - 填写协议(http) 默认：http
        - 服务器 or ip
        - 端口号 不填默认：80
        - 请求方法(get)
         - 路径 栗子:http:主机地址:端口号/text/text_01/模块/接口名?参数1:XXX&参数2:XXX 路径为:/text/text_01
        - Content encoding (编码类型) utf-8
        - 参数 复制后点Add from Clipboard可以直接粘贴过来
    3. 如果是post，以json方式传参，添加HTTP信息头管理器配置，Content-Type application/json
    4. **查看结果树**

### 关于jmeter重定向到登录
1. 流程：注册-登录-操作，此时第三步骤会失败并提示你要登录再操作
2. 原因：在登陆时服务器会创建一个session会话来保存登录的用户信息，并返回这个会话的编号，存储在set-cookie里，按上述流程登录后返回的cookie并没有给到操作这一步，所以服务器认为是未登录的人直接进行此操作，重定向到登录
3. 解决办法：把cookie传给第三步操作，添加jmeter中的配置元件HTTP cookie管理器，此时流程为HTTP cookice管理器-注册-登录-操作====>操作成功
![cookie](https://cdn.jsdelivr.net/gh/liyuqinggg/cdn@1.2/cookie_01.png)

### JDBC
1. jdbc就是针对数据库的请求
2. **添加配置元件 JDBC Connection Configuration** 主要用来配置数据库连接，以下以以mysql为例
    - 添加mysql-connector-java包，[下载](https://dev.mysql.com/downloads/connector/j/)后放到jmeter的lib目录，在测试计划中，选择此jar包
    - ![mysql-connector-java](https://cdn.jsdelivr.net/gh/liyuqinggg/cdn@1.3/jdbc-mysql_01.png)
    - 填写Variable Name，此处需与下方JDBC request Variable Name一致
    - 填写database URL jdbc:mysql://ip:端口/数据库名
    - 配置驱动类 mysql的为 com.mysql.jdbc.Driver
    - username 数据库登录用户名
    - password 数据库密码
    - ![JDBC Connection截图](https://cdn.jsdelivr.net/gh/liyuqinggg/cdn@1.3/jdbc_01.png)
2. **添加采样器 JDBC request** 
    - 填写Variable Name，需与JDBC Connection Configuration Variable name一致
    - 选择Query Type 对应增删改查等
    - 编写sql语句 select id，name，address from text_study;
    - ![JDBC request截图](https://cdn.jsdelivr.net/gh/liyuqinggg/cdn@1.3/jdbc_02.png)
3. **添加察看结果叔**
    - 看到本机地址下mysql中text_01库text_study表里id，name，address字段信息
    - ![察看结果树截图](https://cdn.jsdelivr.net/gh/liyuqinggg/cdn@1.3/jdbc_03.png)

### 参数化三种方式
1. 用户定义的变量
    - 添加配置元件--用户定义的变量，引用方法：${变量名}
    - 注册-登录-下一步操作，重定向到登录页面，原因：未把登录时服务器返回的响应头里面的cookice传给下一步操作接口，所以认为未登录，重定向到登录页面要求登录，解决方法：添加配置元件--HTTP cookice管理器，添加后同级目录下所有需要cookice的地方都会自动传入
2. 配置元件CSV Data Set Config 文档
3. 
